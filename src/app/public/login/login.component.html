<div class="login-container">
  <h1>Iniciar sesiÃ³n</h1>

  <div *ngIf="error" class="error">{{ error }}</div>
  <div *ngIf="loading" class="loading">{{ loading }}</div>

  <form *ngIf="step === 'email'" (ngSubmit)="submitEmail()">
    <label for="email">Correo electrÃ³nico</label>
    <input type="email" [(ngModel)]="email" name="email" id="email" required />
    <button type="submit">Continuar</button>
  </form>

  <div *ngIf="step !== 'email'" class="user-summary">
    <img [src]="user?.photo || '/assets/default-avatar.png'" alt="Avatar" />
    <h2>{{ user?.name }}</h2>
  </div>

  <!-- PASSWORD LOGIN -->
  <form *ngIf="step === 'password'" (ngSubmit)="login()">
    <label for="password">ContraseÃ±a</label>
    <div class="password-field">
      <input
        [type]="showPassword ? 'text' : 'password'"
        [(ngModel)]="password"
        name="password"
        id="password"
        required
      />
      <button type="button" (click)="togglePassword()">
        {{ showPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
      </button>
    </div>
    <button type="submit">Entrar</button>
    <button type="button" (click)="sendOTP()">Â¿Usar cÃ³digo?</button>
    <button type="button" (click)="backTo('email')">â† Cambiar correo</button>
  </form>

  <!-- OTP LOGIN -->
  <form *ngIf="step === 'otp'" (ngSubmit)="verifyOTP()">
    <label for="otp">CÃ³digo recibido</label>
    <input type="text" [(ngModel)]="otp" name="otp" id="otp" required />
    <div *ngIf="requestNewPassword" class="password-field">
      <label for="password">Nueva contraseÃ±a</label>
      <input
        [type]="showPassword ? 'text' : 'password'"
        [(ngModel)]="password"
        name="password"
        id="password"
        required
      />
      <button type="button" (click)="togglePassword()">
        {{ showPassword ? 'ğŸ™ˆ' : 'ğŸ‘ï¸' }}
      </button>
    </div>
    <button type="submit">Entrar</button>
    <button type="button" (click)="sendOTP()">Reenviar cÃ³digo</button>
    <button type="button" *ngIf="allowPassword" (click)="backTo('password')">â† Usar contraseÃ±a</button>
    <button type="button" (click)="backTo('email')">â† Cambiar correo</button>
  </form>
</div>
